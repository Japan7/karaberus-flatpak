id: moe.japan7.karaberus

runtime: org.gnome.Platform
runtime-version: '46'
sdk: org.gnome.Sdk

command: app
finish-args:
  - --socket=wayland
  - --socket=fallback-x11
  - --device=dri
  - --share=ipc
  - --share=network
  - --talk-name=org.freedesktop.Flatpak

modules:
  - name: binary
    buildsystem: simple
    sources:
      - type: file
        url: https://github.com/Japan7/karaberus/releases/download/app-v0.2.0/karaberus_0.2.0_amd64.deb
        sha256: 8cebcb9bd0c780a3951fc3c28e729d34ea2467c93ce9b1ac0d268022ca82f5b3
        only-arches: [x86_64]
    build-commands:
      - ar -x *.deb
      - tar -xf data.tar.gz
      - install -Dm755 usr/bin/app /app/bin/app

  - name: mpv-wrapper
    buildsystem: simple
    sources:
      - type: file
        path: ./mpv
    build-commands:
      - install -Dm555 mpv /app/bin/mpv

  - name: desktop-file
    buildsystem: simple
    sources:
      - type: file
        path: ./moe.japan7.karaberus.desktop
    build-commands:
      - install -Dm644 moe.japan7.karaberus.desktop /app/share/applications/moe.japan7.karaberus.desktop
